<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
    <script type="text/javascript">
        function order(mili) {
            return new Promise((resolve, reject) => {
                setTimeout(() => {
                    console.log(mili);
                    mili = 200 ? reject("reject") : resolve(mili);
                }, mili);
            });
        };
        Promise.all([order(300), order(200), order(100)])
                .then((milis) => console.log("then resolve"),
                    (error) => console.log("then", error));

        /*
            order(mili)가 호출되면 Promise 인스턴스를 생성하면서 setTimeout()을 실행
            파라미터로 받은 mili값을 지연 시간으로 사용

            mili 값이 200이면 reject('reject') 호출 아니면 resolve(mili) 호출

            order() 함수 호출 시 300, 200, 100으로 호출되나 setTimeout 지연시간으로 인해 100, 200, 300으로 실행된다.

            이때 200일 경우 reject('reject')가 실행되어
            then()함수의 2번째 파라미터 함수가 실행되어 에러 로그 출력

            실패가 발생하더라도 중단하지 않고 끝까지 실행 세 번째 300까지 출력한다.

            전체가 끝나면 resolve()를 호출하므로 then() 핸들러 함수가 실행되어야 하는데 앞에서 실패가 발생했으므로 실행되지 않는다.
        */
    </script>
</body>
</html>
